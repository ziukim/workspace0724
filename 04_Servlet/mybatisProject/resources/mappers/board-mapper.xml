<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="BoardMapper">
	<resultMap id="boardResultMap" type="Board">
		<result column="BOARD_NO" property="boardNo"/>
		<result column="CATEGORY_NAME" property="categoryName"/>
		<result column="BOARD_TITLE" property="boardTitle"/>
		<result column="MEMBER_ID" property="memberId"/>
		<result column="COUNT" property="count"/>
		<result column="CREATE_DATE" property="createDate"/>
	</resultMap>
	<select id="selectAllBoardCount" resultType="_int">
		SELECT COUNT(*)
		  FROM BOARD
		 WHERE STATUS = 'Y'
	</select>
	<select id="searchBoardCount" resultType="int">
		SELECT COUNT(*)
		FROM BOARD B
		JOIN MEMBER M ON(BOARD_WRITER = MEMBER_NO)
		WHERE B.STATUS = "Y"
		<choose>
			<when test="condition == 'writer'">
				AND MEMBER_ID
			</when>
			<when test="condition == 'title'">
				AND MEMBER_TITLE
			</when>
			<otherwise>
				AND BOARD_CONTENT
			</otherwise>
		</choose>
		LIKE '#${keyword}%'
	</select>
	<select id="selectAllBoard" resultMap="boardResultMap">
		SELECT  BOARD_NO, 
                CATEGORY_NAME,
                BOARD_TITLE,
                MEMBER_ID,
                COUNT,
                TO_CHAR(CREATE_DATE, 'YYYY-MM-DD') AS "CREATE_DATE"
        FROM BOARD B
        JOIN CATEGORY USING(CATEGORY_NO)
        JOIN MEMBER M ON(BOARD_WRITER = MEMBER_NO)
        WHERE B.STATUS = 'Y'
        AND BOARD_TYPE = 1
        ORDER BY BOARD_NO DESC
	</select>
</mapper>